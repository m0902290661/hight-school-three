<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>獲取 Google Sheets 資料</title>
    <style>
        #a1{
            display: none;
            position: fixed;
            background-color: white;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <div id="a1">
        <img src="loading.gif" alt="">
        <p>載入中．．．</p>
    </div>
    <button onclick="location.href='#bottom'">到底</button>
    <div id="output"></div>
    <p id="bottom">---這是底---</p>

    <script>
        let ga = 0;
        fetchData();
        function fetchData() {
            var scriptURL = "https://script.google.com/macros/s/AKfycbzs6YeKc1UcvLuy17aCNljddGOtm_Dnj13I6P4qvfKRd8iKOQHC_f_tVahSkrBfsk-U/exec"; // 填入部署的 GAS 網址
            goa();
            fetch(scriptURL)
                .then(response => response.json())
                .then(data => {
                    var output = document.getElementById('output');
                    output.innerHTML = "<h3>聊天室</h3>";
                    data.forEach(row => {
                        output.innerHTML += `<p>${row.timestamp} - ${row.name} - ${row.message}</p>`;
                        ca1();
                    });
                })
                .catch(error => console.error('錯誤:', error));
        }

        setInterval(function(){fetchData();},1000);

        //動畫
        function goa(){
            if(ga === 0){
                oa1();
                ga = 1;
            }
        }
        function oa1(){
            document.getElementById('a1').style.display='block';
        }
        function ca1(){
            document.getElementById('a1').style.display='none';
        }
    </script>
</body>
</html>